# Следующие шаги

### DS main - Проанализировать модель - в какую сторону улучшать?
Больше данных, лучше сегментация, выравнивать позы или что-то ещё?

- [x] Сделать страницу-презентацию первых результатов для всех видов партнёрств (SMM, дизайн, владельцы групп и тп.)

- [ ] Можно ли улучшить тренировочный датасет и как?
	- [ ] Больше данных?
- [x] Сгенерировать карты активации для 3, 12, 30 и 60 эпох на дл1-3 и дл4
  - [ ] Собрать 3 папки данных: хорошо сработало, не нашлось (нужно проверить что оно вообще было) и нашлось, но благодаря не нативным фичам (свет, трава, руки)
  - [ ] Попробовать выровнять позу животного и сравнить карту активации
  - [ ] Удалить из train датасета посты, где фотки с похожими помехами, натренируй новую модель, сравни карты активации
- [ ] Проанализировать карты активации:
  - [ ] Больше данных? Улучшить сегментацию? Выпрямлять позы? Что-то ещё?
  - [ ] Попросить помощи:
    - [ ] Email to author kyzhou@hkbu.edu.hk
    - [x] Тимур
    - [ ] Коля
    - [ ] mm.ODS.ai

- [ ] Если карты активации не работают - мб попробовать Occlusion Sensitivity Analysis? (наложить на фото грид и закрашивать его чёрным кусочек за кусочком и строить heatmap по самым важным для предсказания кускам)

### DS
- [ ] Придумать как считать confidence score для ближайших векторов чтобы был вариант постить комменты только если модель уверенна, что нашла матч
- [ ] Попробовать найти классификатор видов животных, если ничего нет - обучить
- [ ] Проанализировать сколько процентов _нашли/потерялся_ объявлений содержат важный текст (город, район) на картинке и сколько % коллажей
  - Если таких достаточное кол-во, придумать как распознавать и вычленять текст на фото: место, контакты

### Data
- [x] Выгрузить побольше данных из ВК
- [ ] Разметить vk_posts (55 тыс фото)
	- [ ] Понять что удалять из тренировочного датасета? Как минимум мы оставляем в каждом посте только одно уникальное животное. Помимо этого - стоит ли удалять посты где все фото одинаково искажённые? Все под прямыми солнечными лучами (шерсть сияет) или все в темноте, либо на фоне какого то яркого предмета который точно просочится через сегментацию? Тот же вопрос по языкам - очень часто бывает что у собаки высунут язык на всех фото (и на хитмапах прямо видно что модель на это цепляется)?
  
- [ ] Собрать в кучу процесс загрузки и подготовки данных (просто скрипт, MLFlow, BentoML, ...?)
- [ ] Продумать и описать процесс очистки данных (зависит от анализа модели):
  - Удалить из тренировочного датасета все посты с очень однородными помехами на фотках, например:
    - Все фото засвечены и шерсть сияет (TODO подумать может быть применить трансформ вроде RandomGamma)
    - На всех фотках высунут язык
    - На всех фотках одна поза
    - На всех фотках человеческие руки/трава/и т.п. в сегменте
- [ ] Собрать список групп в которые будем индексировать и постить объявления


### Main integration

- [ ] Сделать бота ВК
  - [ ] Понять как деплоить модель? Так же, как сейчас предсказываем, напрямую из файла? BentoML?
  - [ ] Решить как именно постить найденных животных. Комментарий к посту со ссылками? Как то ещё?
  - [ ] Сделать пару групп песочниц, чтобы тестировать как именно он работает
  - [ ] Не забыть фильтровать непоисковые объявления: "котята ищут дом" например

### Integration
- [ ] Продумать SMM стратегию - нам нужно чтобы зоозащитники (особенно владельцы групп) и волонтёры знали и любили нас
  - [ ] Найти маркетолога/SMM спеца? https://procharity.ru/, https://itvist.org/
  - [ ] Найти дизайнера для аватарок, лого, стиля текстов: https://procharity.ru/, https://itvist.org/
- [ ] Раскрутить свою группу в которой будет работать бот по началу

- [ ] Собрать список групп в которые будем индексировать и постить объявления
  - Понять как коммуницировать с группами в которых мы будем постить комменты? С одной стороны лучше чтобы они были в курсе, с другой предрассудки и кто-то мб продаёт услуги поиска. Для таких групп есть смысл парсить контакт самого человека кто запостил и писать им напрямую

- [ ] Предложить интеграцию [следопыт.онлайн](https://www.xn--d1abrofhm5e.xn--80asehdb/)
- [ ] Найти похожих компаний на следопыт.онлайн и предложить им интеграцию (https://vk.com/topic-198498843_49362841)

- [ ] Поделиться сырыми и сегментированными данными в чате IT волонтёра, мб d mm.ODS.ai, в других местах

- [x] Проверить правила ВК, можем ли мы вообще так делать? :D = можем, но нужна явная авторизация от владельцев групп, поэтому нужда в хорошем бренде и SMM ещё выше


# Archive
## 20 октября
Как будет выглядеть пайплайн тренирующий OSNet (Re-ID):
- [x] Выгружаем данные из ВК
- [x] Сгребаем всё в одну папку локально
- [x] Запускаем скрипт который удаляет полные и частичные дубликаты (репосты и пр.)
- [x] Используя PixelLib вырезаем сегментированных животных как отдельные изображения в новую папку со след. форматом файла: `post-id_post_photo-num`
- [x] Делаем и запускаем скрипт, который:
	- Удаляет дубликаты
	- раскидает жвотных по папкам, где название папки: `post-id_class-num` либо `post-id_0` если это не сложный сценарий 1
- [x] Обучаем OSNet самым простым способом
- [x] Понять как сравнивать реузльтаты: accuraccy, precision, NDCG, F-mera, F1 или **из статьи**? = mAP + CMC Curve
- [x] Понять как до-обучать OSNet:
	- обучить модель один раз на дост. больших данных
		- а в рантайме просто генерировать эмбеддинги и искать по ним


Сложные вопросы по алгоритму:
1. Как превратить инференс OSNet в эмбедддинги чтобы совместить с другими фичами (вроде текста/вида животного и т.п.)
	- И сколько параметров в этих эмбеддингах? Сможем ли мы это уместить в БД
- Как добавить описание поста в Re-ID
- Какую метрику использовать учитывая то что ложно отрицательные результаты критичны
