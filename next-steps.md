# Следующие шаги

### #1
- [ ] Сгенерировать карты активации для 3, 12, 30 и 60 эпох на дл1-3 и дл4

### DS

### Data

### Other

- Проанализировать карты активации:
  - kyzhou [at] hkbu.edu.hk !!!
  - Тимур, Коля
  - mm.ODS.ai
- Собрать в кучу процесс загрузки и подготовки данных (MLFlow, BentoML, ...?)
- Описать процесс очистки данных:
  - Удалить из тренировочного датасета все посты с очень однородными помехами на фотках, например:
    - Все фото засвечены и шерсть сияет (TODO подумать может быть применить трансформ вроде RandomGamma)
    - На всех фотках высунут язык
    - На всех фотках одна поза
    - На всех фотках человеческие руки/трава/и т.п. в сегменте
- Продумать как считать confidence score для ближайших векторов чтобы был вариант постить комменты только если бот уверен, что нашёл матч 
- Придумать как правильно использовать текст объявления
  - Классифицировать объявление "о поиске" или "о пропаже", и пропускать "раздаю котят" условно говоря (простой RegExp пока справится наверно)
  - Как вытащить оттуда место: 
    - как минимум нормализованное название города (не НиНо, Мск, Кзн)
    - как максимум ещё и район (для больших городов и для пригородов/деревень вокруг обычных городов)
- Собрать список групп в которые будем индексировать и постить объявления
  - Стоит ли им писать что-то? С одной стороны лучше чтобы они были в курсе, с другой предрассудки и кто то мб продаёт услуги поиска. Для таких групп есть смысл парсить контакт самого человека кто запостил и писать им напрямую
- Проверить правила ВК, можем ли мы вообще так делать? :D


## 20 октября
Как будет выглядеть пайплайн тренирующий OSNet (Re-ID):
- [x] Выгружаем данные из ВК
- [x] Сгребаем всё в одну папку локально
- [x] Запускаем скрипт который удаляет полные и частичные дубликаты (репосты и пр.)
- [x] Используя PixelLib вырезаем сегментированных животных как отдельные изображения в новую папку со след. форматом файла: `post-id_post_photo-num`
- [x] Делаем и запускаем скрипт, который:
	- Удаляет дубликаты
	- раскидает жвотных по папкам, где название папки: `post-id_class-num` либо `post-id_0` если это не сложный сценарий 1
- [x] Обучаем OSNet самым простым способом
- [x] Понять как сравнивать реузльтаты: accuraccy, precision, NDCG, F-mera, F1 или **из статьи**? = mAP + CMC Curve
- [ ] Понять как до-обучать OSNet:
	- обучить модель один раз на дост. больших данных
		- а в рантайме просто генерировать эмбеддинги и искать по ним


Сложные вопросы по алгоритму:
1. Как превратить инференс OSNet в эмбедддинги чтобы совместить с другими фичами (вроде текста/вида животного и т.п.)
	- И сколько параметров в этих эмбеддингах? Сможем ли мы это уместить в БД
- Как добавить описание поста в Re-ID
- Какую метрику использовать учитывая то что ложно отрицательные результаты критичны
