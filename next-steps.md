# Следующие шаги

### Проанализировать модель - в какую сторону улучшать?
Больше данных, лучше сегментация, выравнивать позы или что-то ещё?

- [ ] Можно ли улучшить тренировочный датасет и как?
- [x] Сгенерировать карты активации для 3, 12, 30 и 60 эпох на дл1-3 и дл4
- [ ] Проанализировать карты активации:
  - [ ] Больше данных? Улучшить сегментацию? Выпрямлять позы? Что-то ещё?
  - [ ] Попросить помощи:
    - [ ] Email to author kyzhou@hkbu.edu.hk
    - [x] Тимур
    - [ ] Коля
    - [ ] mm.ODS.ai

- [ ] Если карты активации не работают - мб попробовать Occlusion Sensitivity Analysis? (наложить на фото грид и закрашивать его чёрным кусочек за кусочком и строить heatmap по самым важным для предсказания кускам)

### DS
- [ ] Придумать как считать confidence score для ближайших векторов чтобы был вариант постить комменты только если бот уверен, что нашёл матч
- [ ] Попробовать найти классификатор видов животных, если ничего нет - обучить
- [ ] Проанализировать сколько процентов объявлений содержат важный текст (город, район) на картинке и сколько % коллажей
  - Если таких достаточное кол-во, придумать как распознавать и вычленять текст на фото: место, контакты

### Data
- [ ] Собрать в кучу процесс загрузки и подготовки данных (MLFlow, BentoML, ...?)
- [ ] Продумать и описать процесс очистки данных (зависит от анализа модели):
  - Удалить из тренировочного датасета все посты с очень однородными помехами на фотках, например:
    - Все фото засвечены и шерсть сияет (TODO подумать может быть применить трансформ вроде RandomGamma)
    - На всех фотках высунут язык
    - На всех фотках одна поза
    - На всех фотках человеческие руки/трава/и т.п. в сегменте
- [ ] Собрать список групп в которые будем индексировать и постить объявления


### Integration

- [ ] Сделать группу для бота ВК
- [ ] Сделать бота ВК
  - [ ] Решить как именно постить найденных животных. Комментарий к посту со ссылками? Как то ещё?
  - [ ] Сделать пару групп песочниц, чтобы тестировать как именно он работает
  - [ ] Не забыть фильтровать непоисковые объявления: "котята ищут дом" например

### Integration second order
- [ ] Продумать SMM стратегию - нам нужно чтобы зоозащитники (особенно владельцы групп) и волонтёры знали и любили нас
  - [ ] Найти маркетолога/SMM спеца? https://procharity.ru/, https://itvist.org/
  - [ ] Найти дизайнера для аватарок, лого, стиля текстов: https://procharity.ru/, https://itvist.org/

- [ ] Собрать список групп в которые будем индексировать и постить объявления
  - Понять как коммуницировать с группами в которых мы будем постить комменты? С одной стороны лучше чтобы они были в курсе, с другой предрассудки и кто-то мб продаёт услуги поиска. Для таких групп есть смысл парсить контакт самого человека кто запостил и писать им напрямую

- [x] Проверить правила ВК, можем ли мы вообще так делать? :D = можем, мы не храним фотографии и даже текст постов можем не хранить (просто распаковать оттуда место, контакт и время)


# Archive
## 20 октября
Как будет выглядеть пайплайн тренирующий OSNet (Re-ID):
- [x] Выгружаем данные из ВК
- [x] Сгребаем всё в одну папку локально
- [x] Запускаем скрипт который удаляет полные и частичные дубликаты (репосты и пр.)
- [x] Используя PixelLib вырезаем сегментированных животных как отдельные изображения в новую папку со след. форматом файла: `post-id_post_photo-num`
- [x] Делаем и запускаем скрипт, который:
	- Удаляет дубликаты
	- раскидает жвотных по папкам, где название папки: `post-id_class-num` либо `post-id_0` если это не сложный сценарий 1
- [x] Обучаем OSNet самым простым способом
- [x] Понять как сравнивать реузльтаты: accuraccy, precision, NDCG, F-mera, F1 или **из статьи**? = mAP + CMC Curve
- [ ] Понять как до-обучать OSNet:
	- обучить модель один раз на дост. больших данных
		- а в рантайме просто генерировать эмбеддинги и искать по ним


Сложные вопросы по алгоритму:
1. Как превратить инференс OSNet в эмбедддинги чтобы совместить с другими фичами (вроде текста/вида животного и т.п.)
	- И сколько параметров в этих эмбеддингах? Сможем ли мы это уместить в БД
- Как добавить описание поста в Re-ID
- Какую метрику использовать учитывая то что ложно отрицательные результаты критичны
